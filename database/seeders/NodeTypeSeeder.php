<?php

namespace Database\Seeders;

use App\Models\NodeType;
use Illuminate\Database\Seeder;

class NodeTypeSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $nodeTypes = [
            // ================================================================================
            // TRIGGERS - Nodes that start a workflow
            // ================================================================================
            [
                'type' => 'trigger',
                'node_type' => 'webhook',
                'name' => 'Webhook',
                'description' => 'Starts the workflow when a webhook URL is called',
                'icon' => 'webhook',
                'color' => '#6366f1',
                'category' => 'trigger',
                'inputs' => [],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'method',
                        'displayName' => 'HTTP Method',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'GET', 'value' => 'GET'],
                            ['label' => 'POST', 'value' => 'POST'],
                            ['label' => 'PUT', 'value' => 'PUT'],
                            ['label' => 'DELETE', 'value' => 'DELETE'],
                            ['label' => 'PATCH', 'value' => 'PATCH'],
                        ],
                        'default' => 'POST',
                        'required' => true,
                        'description' => 'The HTTP method to listen for',
                    ],
                    [
                        'name' => 'path',
                        'displayName' => 'Webhook Path',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => '/my-webhook',
                        'description' => 'The path for the webhook URL (e.g., /my-webhook)',
                    ],
                    [
                        'name' => 'authentication',
                        'displayName' => 'Authentication',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'None', 'value' => 'none'],
                            ['label' => 'Basic Auth', 'value' => 'basic'],
                            ['label' => 'Header Auth', 'value' => 'header'],
                        ],
                        'default' => 'none',
                        'description' => 'Authentication method for the webhook',
                    ],
                    [
                        'name' => 'response_mode',
                        'displayName' => 'Response Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'On Received', 'value' => 'onReceived'],
                            ['label' => 'Last Node', 'value' => 'lastNode'],
                            ['label' => 'Response Node', 'value' => 'responseNode'],
                        ],
                        'default' => 'onReceived',
                        'description' => 'When to respond to the webhook',
                    ],
                    [
                        'name' => 'response_code',
                        'displayName' => 'Response Code',
                        'type' => 'number',
                        'default' => 200,
                        'description' => 'HTTP response code to return',
                    ],
                ],
            ],
            [
                'type' => 'trigger',
                'node_type' => 'schedule',
                'name' => 'Schedule Trigger',
                'description' => 'Starts the workflow on a schedule (cron)',
                'icon' => 'clock',
                'color' => '#8b5cf6',
                'category' => 'trigger',
                'inputs' => [],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'mode',
                        'displayName' => 'Trigger Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Cron Expression', 'value' => 'cron'],
                            ['label' => 'Interval', 'value' => 'interval'],
                            ['label' => 'At Specific Time', 'value' => 'specificTime'],
                        ],
                        'default' => 'interval',
                        'required' => true,
                    ],
                    [
                        'name' => 'cron',
                        'displayName' => 'Cron Expression',
                        'type' => 'string',
                        'default' => '0 * * * *',
                        'placeholder' => '0 * * * *',
                        'description' => 'Cron expression (minute hour day month weekday)',
                        'displayOptions' => ['show' => ['mode' => ['cron']]],
                    ],
                    [
                        'name' => 'interval_value',
                        'displayName' => 'Interval',
                        'type' => 'number',
                        'default' => 1,
                        'displayOptions' => ['show' => ['mode' => ['interval']]],
                    ],
                    [
                        'name' => 'interval_unit',
                        'displayName' => 'Unit',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Seconds', 'value' => 'seconds'],
                            ['label' => 'Minutes', 'value' => 'minutes'],
                            ['label' => 'Hours', 'value' => 'hours'],
                            ['label' => 'Days', 'value' => 'days'],
                        ],
                        'default' => 'hours',
                        'displayOptions' => ['show' => ['mode' => ['interval']]],
                    ],
                    [
                        'name' => 'hour',
                        'displayName' => 'Hour',
                        'type' => 'number',
                        'default' => 9,
                        'displayOptions' => ['show' => ['mode' => ['specificTime']]],
                    ],
                    [
                        'name' => 'minute',
                        'displayName' => 'Minute',
                        'type' => 'number',
                        'default' => 0,
                        'displayOptions' => ['show' => ['mode' => ['specificTime']]],
                    ],
                    [
                        'name' => 'timezone',
                        'displayName' => 'Timezone',
                        'type' => 'string',
                        'default' => 'UTC',
                        'placeholder' => 'America/New_York',
                    ],
                ],
            ],
            [
                'type' => 'trigger',
                'node_type' => 'manual',
                'name' => 'Manual Trigger',
                'description' => 'Starts the workflow manually with a button click',
                'icon' => 'play',
                'color' => '#10b981',
                'category' => 'trigger',
                'inputs' => [],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'notice',
                        'displayName' => 'Info',
                        'type' => 'notice',
                        'default' => 'This node is used to manually trigger the workflow. Click "Test Workflow" to run.',
                    ],
                ],
            ],
            [
                'type' => 'trigger',
                'node_type' => 'email_trigger',
                'name' => 'Email Trigger (IMAP)',
                'description' => 'Starts the workflow when a new email is received',
                'icon' => 'mail',
                'color' => '#ef4444',
                'category' => 'trigger',
                'inputs' => [],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'IMAP Credential',
                        'type' => 'credential',
                        'credential_type' => 'imap',
                        'required' => true,
                    ],
                    [
                        'name' => 'mailbox',
                        'displayName' => 'Mailbox',
                        'type' => 'string',
                        'default' => 'INBOX',
                    ],
                    [
                        'name' => 'action',
                        'displayName' => 'Action',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Mark as Read', 'value' => 'read'],
                            ['label' => 'Do Nothing', 'value' => 'nothing'],
                        ],
                        'default' => 'read',
                    ],
                ],
            ],

            // ================================================================================
            // CORE ACTIONS - Essential action nodes
            // ================================================================================
            [
                'type' => 'action',
                'node_type' => 'http_request',
                'name' => 'HTTP Request',
                'description' => 'Make HTTP requests to any API or URL',
                'icon' => 'globe',
                'color' => '#3b82f6',
                'category' => 'core',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'method',
                        'displayName' => 'Method',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'GET', 'value' => 'GET'],
                            ['label' => 'POST', 'value' => 'POST'],
                            ['label' => 'PUT', 'value' => 'PUT'],
                            ['label' => 'DELETE', 'value' => 'DELETE'],
                            ['label' => 'PATCH', 'value' => 'PATCH'],
                            ['label' => 'HEAD', 'value' => 'HEAD'],
                            ['label' => 'OPTIONS', 'value' => 'OPTIONS'],
                        ],
                        'default' => 'GET',
                        'required' => true,
                    ],
                    [
                        'name' => 'url',
                        'displayName' => 'URL',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => 'https://api.example.com/endpoint',
                        'description' => 'The URL to make the request to',
                    ],
                    [
                        'name' => 'authentication',
                        'displayName' => 'Authentication',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'None', 'value' => 'none'],
                            ['label' => 'Basic Auth', 'value' => 'basicAuth'],
                            ['label' => 'Bearer Token', 'value' => 'bearerToken'],
                            ['label' => 'API Key', 'value' => 'apiKey'],
                            ['label' => 'OAuth2', 'value' => 'oAuth2'],
                            ['label' => 'Credential', 'value' => 'credential'],
                        ],
                        'default' => 'none',
                    ],
                    [
                        'name' => 'credential_id',
                        'displayName' => 'Credential',
                        'type' => 'credential',
                        'displayOptions' => ['show' => ['authentication' => ['credential']]],
                    ],
                    [
                        'name' => 'bearer_token',
                        'displayName' => 'Bearer Token',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['authentication' => ['bearerToken']]],
                    ],
                    [
                        'name' => 'send_headers',
                        'displayName' => 'Send Headers',
                        'type' => 'boolean',
                        'default' => false,
                    ],
                    [
                        'name' => 'headers',
                        'displayName' => 'Headers',
                        'type' => 'keyvalue',
                        'placeholder' => 'Add Header',
                        'displayOptions' => ['show' => ['send_headers' => [true]]],
                    ],
                    [
                        'name' => 'send_query',
                        'displayName' => 'Send Query Parameters',
                        'type' => 'boolean',
                        'default' => false,
                    ],
                    [
                        'name' => 'query_parameters',
                        'displayName' => 'Query Parameters',
                        'type' => 'keyvalue',
                        'displayOptions' => ['show' => ['send_query' => [true]]],
                    ],
                    [
                        'name' => 'send_body',
                        'displayName' => 'Send Body',
                        'type' => 'boolean',
                        'default' => false,
                        'displayOptions' => ['show' => ['method' => ['POST', 'PUT', 'PATCH']]],
                    ],
                    [
                        'name' => 'body_content_type',
                        'displayName' => 'Body Content Type',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'JSON', 'value' => 'json'],
                            ['label' => 'Form URL Encoded', 'value' => 'form-urlencoded'],
                            ['label' => 'Form Data', 'value' => 'multipart-form-data'],
                            ['label' => 'Raw', 'value' => 'raw'],
                        ],
                        'default' => 'json',
                        'displayOptions' => ['show' => ['send_body' => [true]]],
                    ],
                    [
                        'name' => 'body',
                        'displayName' => 'Body',
                        'type' => 'json',
                        'displayOptions' => ['show' => ['send_body' => [true], 'body_content_type' => ['json']]],
                    ],
                    [
                        'name' => 'body_parameters',
                        'displayName' => 'Body Parameters',
                        'type' => 'keyvalue',
                        'displayOptions' => ['show' => ['send_body' => [true], 'body_content_type' => ['form-urlencoded', 'multipart-form-data']]],
                    ],
                    [
                        'name' => 'timeout',
                        'displayName' => 'Timeout (seconds)',
                        'type' => 'number',
                        'default' => 30,
                        'description' => 'Request timeout in seconds',
                    ],
                    [
                        'name' => 'ignore_ssl',
                        'displayName' => 'Ignore SSL Issues',
                        'type' => 'boolean',
                        'default' => false,
                    ],
                    [
                        'name' => 'response_format',
                        'displayName' => 'Response Format',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Auto-detect', 'value' => 'auto'],
                            ['label' => 'JSON', 'value' => 'json'],
                            ['label' => 'Text', 'value' => 'text'],
                            ['label' => 'File', 'value' => 'file'],
                        ],
                        'default' => 'auto',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'code',
                'name' => 'Code',
                'description' => 'Run custom JavaScript/Python code',
                'icon' => 'code',
                'color' => '#f59e0b',
                'category' => 'core',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'language',
                        'displayName' => 'Language',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'JavaScript', 'value' => 'javascript'],
                            ['label' => 'Python', 'value' => 'python'],
                        ],
                        'default' => 'javascript',
                    ],
                    [
                        'name' => 'mode',
                        'displayName' => 'Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Run Once for All Items', 'value' => 'runOnceForAllItems'],
                            ['label' => 'Run Once for Each Item', 'value' => 'runOnceForEachItem'],
                        ],
                        'default' => 'runOnceForAllItems',
                    ],
                    [
                        'name' => 'code',
                        'displayName' => 'Code',
                        'type' => 'code',
                        'required' => true,
                        'default' => '// Access input data with $input' . "\n" . '// Return data to pass to next node' . "\n" . 'return $input.all();',
                        'description' => 'Write your custom code here',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'set',
                'name' => 'Set',
                'description' => 'Set, modify, or add new data fields',
                'icon' => 'edit',
                'color' => '#06b6d4',
                'category' => 'core',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'mode',
                        'displayName' => 'Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Manual Mapping', 'value' => 'manual'],
                            ['label' => 'JSON', 'value' => 'json'],
                        ],
                        'default' => 'manual',
                    ],
                    [
                        'name' => 'fields',
                        'displayName' => 'Fields to Set',
                        'type' => 'fixedCollection',
                        'typeOptions' => [
                            'multipleValues' => true,
                        ],
                        'displayOptions' => ['show' => ['mode' => ['manual']]],
                        'options' => [
                            [
                                'name' => 'values',
                                'displayName' => 'Values',
                                'values' => [
                                    ['name' => 'name', 'displayName' => 'Field Name', 'type' => 'string', 'required' => true],
                                    ['name' => 'type', 'displayName' => 'Type', 'type' => 'select', 'options' => [
                                        ['label' => 'String', 'value' => 'string'],
                                        ['label' => 'Number', 'value' => 'number'],
                                        ['label' => 'Boolean', 'value' => 'boolean'],
                                        ['label' => 'Array', 'value' => 'array'],
                                        ['label' => 'Object', 'value' => 'object'],
                                    ], 'default' => 'string'],
                                    ['name' => 'value', 'displayName' => 'Value', 'type' => 'string', 'required' => true],
                                ],
                            ],
                        ],
                    ],
                    [
                        'name' => 'json_output',
                        'displayName' => 'JSON',
                        'type' => 'json',
                        'displayOptions' => ['show' => ['mode' => ['json']]],
                    ],
                    [
                        'name' => 'include_other_fields',
                        'displayName' => 'Include Other Input Fields',
                        'type' => 'boolean',
                        'default' => true,
                        'description' => 'Include fields from input that are not being set',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'function',
                'name' => 'Function',
                'description' => 'Transform data using JavaScript expressions',
                'icon' => 'function',
                'color' => '#a855f7',
                'category' => 'core',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'code',
                        'displayName' => 'JavaScript Code',
                        'type' => 'code',
                        'required' => true,
                        'default' => "// Transform each item\nreturn items.map(item => {\n  return {\n    json: {\n      ...item.json,\n      // Add your transformations here\n    }\n  };\n});",
                    ],
                ],
            ],

            // ================================================================================
            // LOGIC / FLOW CONTROL
            // ================================================================================
            [
                'type' => 'logic',
                'node_type' => 'if',
                'name' => 'IF',
                'description' => 'Route data based on a condition (true/false)',
                'icon' => 'git-branch',
                'color' => '#a855f7',
                'category' => 'flow',
                'inputs' => ['main'],
                'outputs' => ['true', 'false'],
                'properties' => [
                    [
                        'name' => 'mode',
                        'displayName' => 'Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Rules', 'value' => 'rules'],
                            ['label' => 'Expression', 'value' => 'expression'],
                        ],
                        'default' => 'rules',
                    ],
                    [
                        'name' => 'conditions',
                        'displayName' => 'Conditions',
                        'type' => 'fixedCollection',
                        'typeOptions' => [
                            'multipleValues' => true,
                        ],
                        'displayOptions' => ['show' => ['mode' => ['rules']]],
                        'options' => [
                            [
                                'name' => 'rules',
                                'displayName' => 'Rules',
                                'values' => [
                                    ['name' => 'field', 'displayName' => 'Field', 'type' => 'string', 'required' => true, 'placeholder' => '{{$json.fieldName}}'],
                                    ['name' => 'operation', 'displayName' => 'Operation', 'type' => 'select', 'options' => [
                                        ['label' => 'Equals', 'value' => 'equals'],
                                        ['label' => 'Not Equals', 'value' => 'notEquals'],
                                        ['label' => 'Greater Than', 'value' => 'gt'],
                                        ['label' => 'Less Than', 'value' => 'lt'],
                                        ['label' => 'Greater or Equal', 'value' => 'gte'],
                                        ['label' => 'Less or Equal', 'value' => 'lte'],
                                        ['label' => 'Contains', 'value' => 'contains'],
                                        ['label' => 'Not Contains', 'value' => 'notContains'],
                                        ['label' => 'Starts With', 'value' => 'startsWith'],
                                        ['label' => 'Ends With', 'value' => 'endsWith'],
                                        ['label' => 'Is Empty', 'value' => 'isEmpty'],
                                        ['label' => 'Is Not Empty', 'value' => 'isNotEmpty'],
                                        ['label' => 'Regex Match', 'value' => 'regex'],
                                    ], 'default' => 'equals'],
                                    ['name' => 'value', 'displayName' => 'Value', 'type' => 'string'],
                                ],
                            ],
                        ],
                    ],
                    [
                        'name' => 'combine_conditions',
                        'displayName' => 'Combine Conditions',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'AND (all must match)', 'value' => 'and'],
                            ['label' => 'OR (any can match)', 'value' => 'or'],
                        ],
                        'default' => 'and',
                        'displayOptions' => ['show' => ['mode' => ['rules']]],
                    ],
                    [
                        'name' => 'expression',
                        'displayName' => 'Expression',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['mode' => ['expression']]],
                        'placeholder' => '{{$json.value > 10}}',
                        'description' => 'JavaScript expression that returns true or false',
                    ],
                ],
            ],
            [
                'type' => 'logic',
                'node_type' => 'switch',
                'name' => 'Switch',
                'description' => 'Route data to different outputs based on rules',
                'icon' => 'shuffle',
                'color' => '#ec4899',
                'category' => 'flow',
                'inputs' => ['main'],
                'outputs' => ['output_0', 'output_1', 'output_2', 'output_3', 'fallback'],
                'properties' => [
                    [
                        'name' => 'mode',
                        'displayName' => 'Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Rules', 'value' => 'rules'],
                            ['label' => 'Expression', 'value' => 'expression'],
                        ],
                        'default' => 'rules',
                    ],
                    [
                        'name' => 'data_type',
                        'displayName' => 'Data Type',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'String', 'value' => 'string'],
                            ['label' => 'Number', 'value' => 'number'],
                            ['label' => 'Boolean', 'value' => 'boolean'],
                        ],
                        'default' => 'string',
                        'displayOptions' => ['show' => ['mode' => ['rules']]],
                    ],
                    [
                        'name' => 'value',
                        'displayName' => 'Value to Switch On',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => '{{$json.status}}',
                        'displayOptions' => ['show' => ['mode' => ['rules']]],
                    ],
                    [
                        'name' => 'rules',
                        'displayName' => 'Routing Rules',
                        'type' => 'fixedCollection',
                        'typeOptions' => [
                            'multipleValues' => true,
                        ],
                        'displayOptions' => ['show' => ['mode' => ['rules']]],
                        'options' => [
                            [
                                'name' => 'rules',
                                'displayName' => 'Rules',
                                'values' => [
                                    ['name' => 'output', 'displayName' => 'Output', 'type' => 'number', 'default' => 0],
                                    ['name' => 'operation', 'displayName' => 'Operation', 'type' => 'select', 'options' => [
                                        ['label' => 'Equals', 'value' => 'equals'],
                                        ['label' => 'Not Equals', 'value' => 'notEquals'],
                                        ['label' => 'Contains', 'value' => 'contains'],
                                        ['label' => 'Regex', 'value' => 'regex'],
                                    ], 'default' => 'equals'],
                                    ['name' => 'value', 'displayName' => 'Value', 'type' => 'string', 'required' => true],
                                ],
                            ],
                        ],
                    ],
                    [
                        'name' => 'fallback_output',
                        'displayName' => 'Fallback Output',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'None (Discard)', 'value' => 'none'],
                            ['label' => 'Fallback Output', 'value' => 'fallback'],
                        ],
                        'default' => 'fallback',
                    ],
                ],
            ],
            [
                'type' => 'logic',
                'node_type' => 'merge',
                'name' => 'Merge',
                'description' => 'Combine data from multiple branches',
                'icon' => 'git-merge',
                'color' => '#6366f1',
                'category' => 'flow',
                'inputs' => ['input_1', 'input_2'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'mode',
                        'displayName' => 'Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Append', 'value' => 'append'],
                            ['label' => 'Merge By Index', 'value' => 'mergeByIndex'],
                            ['label' => 'Merge By Key', 'value' => 'mergeByKey'],
                            ['label' => 'Multiplex', 'value' => 'multiplex'],
                            ['label' => 'Choose Branch', 'value' => 'chooseBranch'],
                            ['label' => 'Wait', 'value' => 'wait'],
                        ],
                        'default' => 'append',
                        'description' => 'How to combine the data',
                    ],
                    [
                        'name' => 'merge_key',
                        'displayName' => 'Property to Match On',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['mode' => ['mergeByKey']]],
                        'placeholder' => 'id',
                    ],
                    [
                        'name' => 'clash_handling',
                        'displayName' => 'Clash Handling',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Always Add Suffix', 'value' => 'addSuffix'],
                            ['label' => 'Prefer Input 1', 'value' => 'preferInput1'],
                            ['label' => 'Prefer Input 2', 'value' => 'preferInput2'],
                        ],
                        'default' => 'preferInput2',
                        'displayOptions' => ['show' => ['mode' => ['mergeByIndex', 'mergeByKey']]],
                    ],
                    [
                        'name' => 'chosen_branch',
                        'displayName' => 'Output',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Input 1', 'value' => 'input1'],
                            ['label' => 'Input 2', 'value' => 'input2'],
                        ],
                        'default' => 'input1',
                        'displayOptions' => ['show' => ['mode' => ['chooseBranch']]],
                    ],
                ],
            ],
            [
                'type' => 'logic',
                'node_type' => 'loop',
                'name' => 'Loop Over Items',
                'description' => 'Loop over items and process them individually',
                'icon' => 'repeat',
                'color' => '#14b8a6',
                'category' => 'flow',
                'inputs' => ['main'],
                'outputs' => ['loop', 'done'],
                'properties' => [
                    [
                        'name' => 'mode',
                        'displayName' => 'Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Each Item', 'value' => 'each'],
                            ['label' => 'Batches', 'value' => 'batches'],
                        ],
                        'default' => 'each',
                    ],
                    [
                        'name' => 'batch_size',
                        'displayName' => 'Batch Size',
                        'type' => 'number',
                        'default' => 10,
                        'displayOptions' => ['show' => ['mode' => ['batches']]],
                    ],
                    [
                        'name' => 'options',
                        'displayName' => 'Options',
                        'type' => 'collection',
                        'options' => [
                            ['name' => 'reset', 'displayName' => 'Reset', 'type' => 'boolean', 'default' => false],
                        ],
                    ],
                ],
            ],
            [
                'type' => 'logic',
                'node_type' => 'split_in_batches',
                'name' => 'Split In Batches',
                'description' => 'Split items into smaller batches',
                'icon' => 'layers',
                'color' => '#0ea5e9',
                'category' => 'flow',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'batch_size',
                        'displayName' => 'Batch Size',
                        'type' => 'number',
                        'default' => 10,
                        'required' => true,
                        'description' => 'Number of items per batch',
                    ],
                ],
            ],
            [
                'type' => 'logic',
                'node_type' => 'no_op',
                'name' => 'No Operation',
                'description' => 'Do nothing, just pass data through (useful for organizing)',
                'icon' => 'arrow-right',
                'color' => '#94a3b8',
                'category' => 'flow',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [],
            ],
            [
                'type' => 'logic',
                'node_type' => 'stop_and_error',
                'name' => 'Stop and Error',
                'description' => 'Stop workflow execution with an error',
                'icon' => 'alert-octagon',
                'color' => '#ef4444',
                'category' => 'flow',
                'inputs' => ['main'],
                'outputs' => [],
                'properties' => [
                    [
                        'name' => 'error_type',
                        'displayName' => 'Error Type',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Error Message', 'value' => 'errorMessage'],
                            ['label' => 'Workflow Error', 'value' => 'workflowError'],
                        ],
                        'default' => 'errorMessage',
                    ],
                    [
                        'name' => 'message',
                        'displayName' => 'Error Message',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => 'An error occurred',
                    ],
                ],
            ],

            // ================================================================================
            // DATA TRANSFORMATION
            // ================================================================================
            [
                'type' => 'transform',
                'node_type' => 'filter',
                'name' => 'Filter',
                'description' => 'Filter items based on conditions',
                'icon' => 'filter',
                'color' => '#f97316',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['kept', 'discarded'],
                'properties' => [
                    [
                        'name' => 'conditions',
                        'displayName' => 'Keep Items Where',
                        'type' => 'fixedCollection',
                        'typeOptions' => [
                            'multipleValues' => true,
                        ],
                        'options' => [
                            [
                                'name' => 'conditions',
                                'displayName' => 'Conditions',
                                'values' => [
                                    ['name' => 'field', 'displayName' => 'Field', 'type' => 'string', 'required' => true],
                                    ['name' => 'operation', 'displayName' => 'Operation', 'type' => 'select', 'options' => [
                                        ['label' => 'Equals', 'value' => 'equals'],
                                        ['label' => 'Not Equals', 'value' => 'notEquals'],
                                        ['label' => 'Greater Than', 'value' => 'gt'],
                                        ['label' => 'Less Than', 'value' => 'lt'],
                                        ['label' => 'Contains', 'value' => 'contains'],
                                        ['label' => 'Is Empty', 'value' => 'isEmpty'],
                                        ['label' => 'Is Not Empty', 'value' => 'isNotEmpty'],
                                        ['label' => 'Exists', 'value' => 'exists'],
                                        ['label' => 'Type Is', 'value' => 'typeIs'],
                                    ], 'default' => 'equals'],
                                    ['name' => 'value', 'displayName' => 'Value', 'type' => 'string'],
                                ],
                            ],
                        ],
                    ],
                    [
                        'name' => 'combine',
                        'displayName' => 'Combine',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'AND', 'value' => 'and'],
                            ['label' => 'OR', 'value' => 'or'],
                        ],
                        'default' => 'and',
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'sort',
                'name' => 'Sort',
                'description' => 'Sort items by field values',
                'icon' => 'arrow-up-down',
                'color' => '#84cc16',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'sort_fields',
                        'displayName' => 'Sort By',
                        'type' => 'fixedCollection',
                        'typeOptions' => [
                            'multipleValues' => true,
                        ],
                        'options' => [
                            [
                                'name' => 'fields',
                                'displayName' => 'Fields',
                                'values' => [
                                    ['name' => 'field', 'displayName' => 'Field Name', 'type' => 'string', 'required' => true],
                                    ['name' => 'order', 'displayName' => 'Order', 'type' => 'select', 'options' => [
                                        ['label' => 'Ascending', 'value' => 'asc'],
                                        ['label' => 'Descending', 'value' => 'desc'],
                                    ], 'default' => 'asc'],
                                ],
                            ],
                        ],
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'limit',
                'name' => 'Limit',
                'description' => 'Limit the number of items',
                'icon' => 'hash',
                'color' => '#78716c',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'max_items',
                        'displayName' => 'Max Items',
                        'type' => 'number',
                        'default' => 10,
                        'required' => true,
                    ],
                    [
                        'name' => 'keep',
                        'displayName' => 'Keep',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'First Items', 'value' => 'first'],
                            ['label' => 'Last Items', 'value' => 'last'],
                        ],
                        'default' => 'first',
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'remove_duplicates',
                'name' => 'Remove Duplicates',
                'description' => 'Remove duplicate items based on a field',
                'icon' => 'copy-x',
                'color' => '#64748b',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'compare',
                        'displayName' => 'Compare',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'All Fields', 'value' => 'allFields'],
                            ['label' => 'Selected Fields', 'value' => 'selectedFields'],
                        ],
                        'default' => 'allFields',
                    ],
                    [
                        'name' => 'fields',
                        'displayName' => 'Fields to Compare',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['compare' => ['selectedFields']]],
                        'placeholder' => 'id, email',
                        'description' => 'Comma-separated field names',
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'split_out',
                'name' => 'Split Out',
                'description' => 'Split an array field into separate items',
                'icon' => 'unfold-vertical',
                'color' => '#0ea5e9',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'field',
                        'displayName' => 'Field to Split',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => 'items',
                    ],
                    [
                        'name' => 'include_other_fields',
                        'displayName' => 'Include Other Fields',
                        'type' => 'boolean',
                        'default' => true,
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'aggregate',
                'name' => 'Aggregate',
                'description' => 'Aggregate items into a single item',
                'icon' => 'sigma',
                'color' => '#d946ef',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'aggregate',
                        'displayName' => 'Aggregate',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Individual Fields', 'value' => 'individualFields'],
                            ['label' => 'All Item Data', 'value' => 'allItemData'],
                        ],
                        'default' => 'allItemData',
                    ],
                    [
                        'name' => 'fields',
                        'displayName' => 'Fields to Aggregate',
                        'type' => 'fixedCollection',
                        'typeOptions' => ['multipleValues' => true],
                        'displayOptions' => ['show' => ['aggregate' => ['individualFields']]],
                        'options' => [
                            [
                                'name' => 'fieldToAggregate',
                                'displayName' => 'Field',
                                'values' => [
                                    ['name' => 'fieldToAggregate', 'displayName' => 'Input Field', 'type' => 'string', 'required' => true],
                                    ['name' => 'aggregation', 'displayName' => 'Aggregation', 'type' => 'select', 'options' => [
                                        ['label' => 'Append', 'value' => 'append'],
                                        ['label' => 'Sum', 'value' => 'sum'],
                                        ['label' => 'Average', 'value' => 'average'],
                                        ['label' => 'Min', 'value' => 'min'],
                                        ['label' => 'Max', 'value' => 'max'],
                                        ['label' => 'Count', 'value' => 'count'],
                                        ['label' => 'Count Unique', 'value' => 'countUnique'],
                                        ['label' => 'First', 'value' => 'first'],
                                        ['label' => 'Last', 'value' => 'last'],
                                    ], 'default' => 'append'],
                                    ['name' => 'outputField', 'displayName' => 'Output Field', 'type' => 'string'],
                                ],
                            ],
                        ],
                    ],
                    [
                        'name' => 'destination_field',
                        'displayName' => 'Destination Field',
                        'type' => 'string',
                        'default' => 'data',
                        'displayOptions' => ['show' => ['aggregate' => ['allItemData']]],
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'rename_keys',
                'name' => 'Rename Keys',
                'description' => 'Rename fields in items',
                'icon' => 'tag',
                'color' => '#22d3ee',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'renameKeys',
                        'displayName' => 'Keys to Rename',
                        'type' => 'fixedCollection',
                        'typeOptions' => ['multipleValues' => true],
                        'options' => [
                            [
                                'name' => 'keys',
                                'displayName' => 'Keys',
                                'values' => [
                                    ['name' => 'currentKey', 'displayName' => 'Current Key', 'type' => 'string', 'required' => true],
                                    ['name' => 'newKey', 'displayName' => 'New Key', 'type' => 'string', 'required' => true],
                                ],
                            ],
                        ],
                    ],
                ],
            ],
            [
                'type' => 'transform',
                'node_type' => 'item_lists',
                'name' => 'Item Lists',
                'description' => 'Work with item lists (concatenate, limit, sort, etc.)',
                'icon' => 'list',
                'color' => '#3b82f6',
                'category' => 'transform',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Concatenate Items', 'value' => 'concatenateItems'],
                            ['label' => 'Limit', 'value' => 'limit'],
                            ['label' => 'Remove Duplicates', 'value' => 'removeDuplicates'],
                            ['label' => 'Sort', 'value' => 'sort'],
                            ['label' => 'Split Out Items', 'value' => 'splitOutItems'],
                            ['label' => 'Summarize', 'value' => 'summarize'],
                        ],
                        'default' => 'concatenateItems',
                    ],
                ],
            ],

            // ================================================================================
            // COMMUNICATION
            // ================================================================================
            [
                'type' => 'action',
                'node_type' => 'email_send',
                'name' => 'Send Email',
                'description' => 'Send an email via SMTP',
                'icon' => 'mail',
                'color' => '#ef4444',
                'category' => 'communication',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'SMTP Credential',
                        'type' => 'credential',
                        'credential_type' => 'smtp',
                        'required' => true,
                    ],
                    [
                        'name' => 'from_email',
                        'displayName' => 'From Email',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => 'noreply@example.com',
                    ],
                    [
                        'name' => 'from_name',
                        'displayName' => 'From Name',
                        'type' => 'string',
                        'placeholder' => 'My App',
                    ],
                    [
                        'name' => 'to',
                        'displayName' => 'To',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => 'recipient@example.com',
                    ],
                    [
                        'name' => 'cc',
                        'displayName' => 'CC',
                        'type' => 'string',
                    ],
                    [
                        'name' => 'bcc',
                        'displayName' => 'BCC',
                        'type' => 'string',
                    ],
                    [
                        'name' => 'subject',
                        'displayName' => 'Subject',
                        'type' => 'string',
                        'required' => true,
                    ],
                    [
                        'name' => 'email_format',
                        'displayName' => 'Email Format',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Text', 'value' => 'text'],
                            ['label' => 'HTML', 'value' => 'html'],
                        ],
                        'default' => 'text',
                    ],
                    [
                        'name' => 'body',
                        'displayName' => 'Body',
                        'type' => 'text',
                        'required' => true,
                    ],
                    [
                        'name' => 'attachments',
                        'displayName' => 'Attachments',
                        'type' => 'string',
                        'description' => 'Binary property name containing the attachment',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'slack',
                'name' => 'Slack',
                'description' => 'Send messages to Slack',
                'icon' => 'slack',
                'color' => '#4A154B',
                'category' => 'communication',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'Slack Credential',
                        'type' => 'credential',
                        'credential_type' => 'slack',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Send Message', 'value' => 'postMessage'],
                            ['label' => 'Update Message', 'value' => 'updateMessage'],
                            ['label' => 'Delete Message', 'value' => 'deleteMessage'],
                            ['label' => 'Get Channel', 'value' => 'getChannel'],
                            ['label' => 'Get All Channels', 'value' => 'getAllChannels'],
                        ],
                        'default' => 'postMessage',
                    ],
                    [
                        'name' => 'channel',
                        'displayName' => 'Channel',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => '#general or C123456',
                    ],
                    [
                        'name' => 'text',
                        'displayName' => 'Message Text',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['operation' => ['postMessage', 'updateMessage']]],
                    ],
                    [
                        'name' => 'blocks',
                        'displayName' => 'Blocks (JSON)',
                        'type' => 'json',
                        'description' => 'Slack Block Kit blocks',
                        'displayOptions' => ['show' => ['operation' => ['postMessage', 'updateMessage']]],
                    ],
                    [
                        'name' => 'ts',
                        'displayName' => 'Message Timestamp',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['updateMessage', 'deleteMessage']]],
                        'description' => 'Timestamp of message to update/delete',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'discord',
                'name' => 'Discord',
                'description' => 'Send messages to Discord',
                'icon' => 'discord',
                'color' => '#5865F2',
                'category' => 'communication',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'Discord Credential',
                        'type' => 'credential',
                        'credential_type' => 'discord',
                    ],
                    [
                        'name' => 'authentication',
                        'displayName' => 'Authentication',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Webhook', 'value' => 'webhook'],
                            ['label' => 'Bot Token', 'value' => 'botToken'],
                        ],
                        'default' => 'webhook',
                    ],
                    [
                        'name' => 'webhook_url',
                        'displayName' => 'Webhook URL',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['authentication' => ['webhook']]],
                        'placeholder' => 'https://discord.com/api/webhooks/...',
                    ],
                    [
                        'name' => 'content',
                        'displayName' => 'Message',
                        'type' => 'text',
                        'required' => true,
                    ],
                    [
                        'name' => 'embeds',
                        'displayName' => 'Embeds (JSON)',
                        'type' => 'json',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'telegram',
                'name' => 'Telegram',
                'description' => 'Send messages via Telegram',
                'icon' => 'telegram',
                'color' => '#0088cc',
                'category' => 'communication',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'Telegram Credential',
                        'type' => 'credential',
                        'credential_type' => 'telegram',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Send Message', 'value' => 'sendMessage'],
                            ['label' => 'Send Photo', 'value' => 'sendPhoto'],
                            ['label' => 'Send Document', 'value' => 'sendDocument'],
                        ],
                        'default' => 'sendMessage',
                    ],
                    [
                        'name' => 'chat_id',
                        'displayName' => 'Chat ID',
                        'type' => 'string',
                        'required' => true,
                    ],
                    [
                        'name' => 'text',
                        'displayName' => 'Message Text',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['operation' => ['sendMessage']]],
                    ],
                    [
                        'name' => 'parse_mode',
                        'displayName' => 'Parse Mode',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'None', 'value' => 'none'],
                            ['label' => 'Markdown', 'value' => 'Markdown'],
                            ['label' => 'HTML', 'value' => 'HTML'],
                        ],
                        'default' => 'none',
                    ],
                ],
            ],

            // ================================================================================
            // DATABASE
            // ================================================================================
            [
                'type' => 'action',
                'node_type' => 'mysql',
                'name' => 'MySQL',
                'description' => 'Execute MySQL queries',
                'icon' => 'database',
                'color' => '#4479A1',
                'category' => 'database',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'MySQL Credential',
                        'type' => 'credential',
                        'credential_type' => 'mysql',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Execute Query', 'value' => 'executeQuery'],
                            ['label' => 'Insert', 'value' => 'insert'],
                            ['label' => 'Update', 'value' => 'update'],
                            ['label' => 'Delete', 'value' => 'delete'],
                        ],
                        'default' => 'executeQuery',
                    ],
                    [
                        'name' => 'query',
                        'displayName' => 'Query',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['operation' => ['executeQuery']]],
                        'placeholder' => 'SELECT * FROM users WHERE id = ?',
                    ],
                    [
                        'name' => 'table',
                        'displayName' => 'Table',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['insert', 'update', 'delete']]],
                    ],
                    [
                        'name' => 'columns',
                        'displayName' => 'Columns',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['insert', 'update']]],
                        'description' => 'Comma-separated list of columns to insert/update',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'postgres',
                'name' => 'PostgreSQL',
                'description' => 'Execute PostgreSQL queries',
                'icon' => 'database',
                'color' => '#336791',
                'category' => 'database',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'PostgreSQL Credential',
                        'type' => 'credential',
                        'credential_type' => 'postgres',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Execute Query', 'value' => 'executeQuery'],
                            ['label' => 'Insert', 'value' => 'insert'],
                            ['label' => 'Update', 'value' => 'update'],
                            ['label' => 'Delete', 'value' => 'delete'],
                        ],
                        'default' => 'executeQuery',
                    ],
                    [
                        'name' => 'query',
                        'displayName' => 'Query',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['operation' => ['executeQuery']]],
                    ],
                    [
                        'name' => 'table',
                        'displayName' => 'Table',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['insert', 'update', 'delete']]],
                    ],
                    [
                        'name' => 'columns',
                        'displayName' => 'Columns',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['insert', 'update']]],
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'mongodb',
                'name' => 'MongoDB',
                'description' => 'Execute MongoDB operations',
                'icon' => 'database',
                'color' => '#47A248',
                'category' => 'database',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'MongoDB Credential',
                        'type' => 'credential',
                        'credential_type' => 'mongodb',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Find', 'value' => 'find'],
                            ['label' => 'Find One', 'value' => 'findOne'],
                            ['label' => 'Insert', 'value' => 'insert'],
                            ['label' => 'Update', 'value' => 'update'],
                            ['label' => 'Delete', 'value' => 'delete'],
                            ['label' => 'Aggregate', 'value' => 'aggregate'],
                        ],
                        'default' => 'find',
                    ],
                    [
                        'name' => 'collection',
                        'displayName' => 'Collection',
                        'type' => 'string',
                        'required' => true,
                    ],
                    [
                        'name' => 'query',
                        'displayName' => 'Query (JSON)',
                        'type' => 'json',
                        'displayOptions' => ['show' => ['operation' => ['find', 'findOne', 'update', 'delete']]],
                    ],
                    [
                        'name' => 'document',
                        'displayName' => 'Document (JSON)',
                        'type' => 'json',
                        'displayOptions' => ['show' => ['operation' => ['insert', 'update']]],
                    ],
                    [
                        'name' => 'pipeline',
                        'displayName' => 'Aggregation Pipeline (JSON)',
                        'type' => 'json',
                        'displayOptions' => ['show' => ['operation' => ['aggregate']]],
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'redis',
                'name' => 'Redis',
                'description' => 'Execute Redis commands',
                'icon' => 'database',
                'color' => '#DC382D',
                'category' => 'database',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'Redis Credential',
                        'type' => 'credential',
                        'credential_type' => 'redis',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Get', 'value' => 'get'],
                            ['label' => 'Set', 'value' => 'set'],
                            ['label' => 'Delete', 'value' => 'delete'],
                            ['label' => 'Increment', 'value' => 'incr'],
                            ['label' => 'Push', 'value' => 'push'],
                            ['label' => 'Pop', 'value' => 'pop'],
                            ['label' => 'Publish', 'value' => 'publish'],
                        ],
                        'default' => 'get',
                    ],
                    [
                        'name' => 'key',
                        'displayName' => 'Key',
                        'type' => 'string',
                        'required' => true,
                    ],
                    [
                        'name' => 'value',
                        'displayName' => 'Value',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['set', 'push', 'publish']]],
                    ],
                    [
                        'name' => 'ttl',
                        'displayName' => 'TTL (seconds)',
                        'type' => 'number',
                        'displayOptions' => ['show' => ['operation' => ['set']]],
                    ],
                ],
            ],

            // ================================================================================
            // FILES & STORAGE
            // ================================================================================
            [
                'type' => 'action',
                'node_type' => 'read_write_file',
                'name' => 'Read/Write File',
                'description' => 'Read from or write to local files',
                'icon' => 'file',
                'color' => '#64748b',
                'category' => 'files',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Read from File', 'value' => 'read'],
                            ['label' => 'Write to File', 'value' => 'write'],
                        ],
                        'default' => 'read',
                    ],
                    [
                        'name' => 'file_path',
                        'displayName' => 'File Path',
                        'type' => 'string',
                        'required' => true,
                        'placeholder' => '/path/to/file.txt',
                    ],
                    [
                        'name' => 'content',
                        'displayName' => 'File Content',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['operation' => ['write']]],
                    ],
                    [
                        'name' => 'encoding',
                        'displayName' => 'Encoding',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'UTF-8', 'value' => 'utf8'],
                            ['label' => 'Base64', 'value' => 'base64'],
                            ['label' => 'Binary', 'value' => 'binary'],
                        ],
                        'default' => 'utf8',
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 's3',
                'name' => 'AWS S3',
                'description' => 'Upload, download, and manage files in AWS S3',
                'icon' => 'cloud',
                'color' => '#FF9900',
                'category' => 'files',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'AWS S3 Credential',
                        'type' => 'credential',
                        'credential_type' => 'aws',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Upload', 'value' => 'upload'],
                            ['label' => 'Download', 'value' => 'download'],
                            ['label' => 'Delete', 'value' => 'delete'],
                            ['label' => 'List', 'value' => 'list'],
                            ['label' => 'Get Signed URL', 'value' => 'getSignedUrl'],
                        ],
                        'default' => 'upload',
                    ],
                    [
                        'name' => 'bucket',
                        'displayName' => 'Bucket',
                        'type' => 'string',
                        'required' => true,
                    ],
                    [
                        'name' => 'key',
                        'displayName' => 'File Key',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['upload', 'download', 'delete', 'getSignedUrl']]],
                    ],
                    [
                        'name' => 'prefix',
                        'displayName' => 'Prefix',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['list']]],
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'ftp',
                'name' => 'FTP',
                'description' => 'Transfer files via FTP/SFTP',
                'icon' => 'folder-sync',
                'color' => '#0078D4',
                'category' => 'files',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'FTP Credential',
                        'type' => 'credential',
                        'credential_type' => 'ftp',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Upload', 'value' => 'upload'],
                            ['label' => 'Download', 'value' => 'download'],
                            ['label' => 'List', 'value' => 'list'],
                            ['label' => 'Delete', 'value' => 'delete'],
                        ],
                        'default' => 'download',
                    ],
                    [
                        'name' => 'remote_path',
                        'displayName' => 'Remote Path',
                        'type' => 'string',
                        'required' => true,
                    ],
                ],
            ],
            [
                'type' => 'action',
                'node_type' => 'google_drive',
                'name' => 'Google Drive',
                'description' => 'Manage files in Google Drive',
                'icon' => 'google-drive',
                'color' => '#4285F4',
                'category' => 'files',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'credential_id',
                        'displayName' => 'Google Drive Credential',
                        'type' => 'credential',
                        'credential_type' => 'google',
                        'required' => true,
                    ],
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Upload', 'value' => 'upload'],
                            ['label' => 'Download', 'value' => 'download'],
                            ['label' => 'List', 'value' => 'list'],
                            ['label' => 'Delete', 'value' => 'delete'],
                            ['label' => 'Share', 'value' => 'share'],
                        ],
                        'default' => 'list',
                    ],
                    [
                        'name' => 'file_id',
                        'displayName' => 'File ID',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['download', 'delete', 'share']]],
                    ],
                    [
                        'name' => 'folder_id',
                        'displayName' => 'Folder ID',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['upload', 'list']]],
                    ],
                ],
            ],

            // ================================================================================
            // UTILITIES
            // ================================================================================
            [
                'type' => 'utility',
                'node_type' => 'wait',
                'name' => 'Wait',
                'description' => 'Pause workflow execution',
                'icon' => 'clock',
                'color' => '#64748b',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'resume',
                        'displayName' => 'Resume',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'After Time Interval', 'value' => 'timeInterval'],
                            ['label' => 'At Specific Time', 'value' => 'specificTime'],
                            ['label' => 'On Webhook Call', 'value' => 'webhook'],
                        ],
                        'default' => 'timeInterval',
                    ],
                    [
                        'name' => 'amount',
                        'displayName' => 'Wait Amount',
                        'type' => 'number',
                        'default' => 1,
                        'displayOptions' => ['show' => ['resume' => ['timeInterval']]],
                    ],
                    [
                        'name' => 'unit',
                        'displayName' => 'Unit',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Seconds', 'value' => 'seconds'],
                            ['label' => 'Minutes', 'value' => 'minutes'],
                            ['label' => 'Hours', 'value' => 'hours'],
                            ['label' => 'Days', 'value' => 'days'],
                        ],
                        'default' => 'seconds',
                        'displayOptions' => ['show' => ['resume' => ['timeInterval']]],
                    ],
                    [
                        'name' => 'date_time',
                        'displayName' => 'Date & Time',
                        'type' => 'datetime',
                        'displayOptions' => ['show' => ['resume' => ['specificTime']]],
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'execute_workflow',
                'name' => 'Execute Workflow',
                'description' => 'Execute another workflow',
                'icon' => 'workflow',
                'color' => '#0891b2',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'source',
                        'displayName' => 'Source',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Database', 'value' => 'database'],
                            ['label' => 'Parameter', 'value' => 'parameter'],
                        ],
                        'default' => 'database',
                    ],
                    [
                        'name' => 'workflow_id',
                        'displayName' => 'Workflow',
                        'type' => 'workflow',
                        'displayOptions' => ['show' => ['source' => ['database']]],
                        'required' => true,
                    ],
                    [
                        'name' => 'wait_for_completion',
                        'displayName' => 'Wait for Sub-Workflow',
                        'type' => 'boolean',
                        'default' => true,
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'datetime',
                'name' => 'Date & Time',
                'description' => 'Work with dates and times',
                'icon' => 'calendar',
                'color' => '#8b5cf6',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Get Current Date', 'value' => 'now'],
                            ['label' => 'Format Date', 'value' => 'format'],
                            ['label' => 'Add/Subtract', 'value' => 'calculate'],
                            ['label' => 'Parse Date', 'value' => 'parse'],
                            ['label' => 'Compare Dates', 'value' => 'compare'],
                        ],
                        'default' => 'now',
                    ],
                    [
                        'name' => 'date',
                        'displayName' => 'Date',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['operation' => ['format', 'calculate', 'parse', 'compare']]],
                    ],
                    [
                        'name' => 'format',
                        'displayName' => 'Output Format',
                        'type' => 'string',
                        'default' => 'YYYY-MM-DD HH:mm:ss',
                        'placeholder' => 'YYYY-MM-DD',
                    ],
                    [
                        'name' => 'amount',
                        'displayName' => 'Amount',
                        'type' => 'number',
                        'displayOptions' => ['show' => ['operation' => ['calculate']]],
                    ],
                    [
                        'name' => 'time_unit',
                        'displayName' => 'Unit',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Seconds', 'value' => 'seconds'],
                            ['label' => 'Minutes', 'value' => 'minutes'],
                            ['label' => 'Hours', 'value' => 'hours'],
                            ['label' => 'Days', 'value' => 'days'],
                            ['label' => 'Weeks', 'value' => 'weeks'],
                            ['label' => 'Months', 'value' => 'months'],
                            ['label' => 'Years', 'value' => 'years'],
                        ],
                        'default' => 'days',
                        'displayOptions' => ['show' => ['operation' => ['calculate']]],
                    ],
                    [
                        'name' => 'timezone',
                        'displayName' => 'Timezone',
                        'type' => 'string',
                        'default' => 'UTC',
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'crypto',
                'name' => 'Crypto',
                'description' => 'Hash, encrypt, or generate random values',
                'icon' => 'lock',
                'color' => '#f59e0b',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'action',
                        'displayName' => 'Action',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Hash', 'value' => 'hash'],
                            ['label' => 'HMAC', 'value' => 'hmac'],
                            ['label' => 'Encrypt', 'value' => 'encrypt'],
                            ['label' => 'Decrypt', 'value' => 'decrypt'],
                            ['label' => 'Generate', 'value' => 'generate'],
                        ],
                        'default' => 'hash',
                    ],
                    [
                        'name' => 'type',
                        'displayName' => 'Hash Type',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'MD5', 'value' => 'MD5'],
                            ['label' => 'SHA256', 'value' => 'SHA256'],
                            ['label' => 'SHA512', 'value' => 'SHA512'],
                        ],
                        'default' => 'SHA256',
                        'displayOptions' => ['show' => ['action' => ['hash', 'hmac']]],
                    ],
                    [
                        'name' => 'value',
                        'displayName' => 'Value',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['action' => ['hash', 'hmac', 'encrypt', 'decrypt']]],
                    ],
                    [
                        'name' => 'secret',
                        'displayName' => 'Secret Key',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['action' => ['hmac', 'encrypt', 'decrypt']]],
                    ],
                    [
                        'name' => 'generate_type',
                        'displayName' => 'Generate Type',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'UUID', 'value' => 'uuid'],
                            ['label' => 'Random String', 'value' => 'randomString'],
                            ['label' => 'Random Number', 'value' => 'randomNumber'],
                        ],
                        'displayOptions' => ['show' => ['action' => ['generate']]],
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'html_extract',
                'name' => 'HTML Extract',
                'description' => 'Extract data from HTML',
                'icon' => 'code',
                'color' => '#06b6d4',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'source',
                        'displayName' => 'HTML Source',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'JSON Property', 'value' => 'json'],
                            ['label' => 'Binary Property', 'value' => 'binary'],
                        ],
                        'default' => 'json',
                    ],
                    [
                        'name' => 'source_property',
                        'displayName' => 'Source Property',
                        'type' => 'string',
                        'default' => 'html',
                    ],
                    [
                        'name' => 'extractions',
                        'displayName' => 'Extraction Values',
                        'type' => 'fixedCollection',
                        'typeOptions' => ['multipleValues' => true],
                        'options' => [
                            [
                                'name' => 'values',
                                'displayName' => 'Values',
                                'values' => [
                                    ['name' => 'key', 'displayName' => 'Key', 'type' => 'string', 'required' => true],
                                    ['name' => 'cssSelector', 'displayName' => 'CSS Selector', 'type' => 'string', 'required' => true],
                                    ['name' => 'returnValue', 'displayName' => 'Return Value', 'type' => 'select', 'options' => [
                                        ['label' => 'Text', 'value' => 'text'],
                                        ['label' => 'HTML', 'value' => 'html'],
                                        ['label' => 'Attribute', 'value' => 'attribute'],
                                    ], 'default' => 'text'],
                                    ['name' => 'attribute', 'displayName' => 'Attribute', 'type' => 'string'],
                                ],
                            ],
                        ],
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'json_parse',
                'name' => 'JSON Parse',
                'description' => 'Parse JSON data from text',
                'icon' => 'braces',
                'color' => '#22c55e',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'source',
                        'displayName' => 'Source',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'JSON Property', 'value' => 'json'],
                            ['label' => 'Input String', 'value' => 'string'],
                        ],
                        'default' => 'json',
                    ],
                    [
                        'name' => 'json_property',
                        'displayName' => 'JSON Property',
                        'type' => 'string',
                        'displayOptions' => ['show' => ['source' => ['json']]],
                    ],
                    [
                        'name' => 'string_input',
                        'displayName' => 'JSON String',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['source' => ['string']]],
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'xml',
                'name' => 'XML',
                'description' => 'Convert between XML and JSON',
                'icon' => 'file-code',
                'color' => '#f97316',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'XML to JSON', 'value' => 'xmlToJson'],
                            ['label' => 'JSON to XML', 'value' => 'jsonToXml'],
                        ],
                        'default' => 'xmlToJson',
                    ],
                    [
                        'name' => 'property_name',
                        'displayName' => 'Property Name',
                        'type' => 'string',
                        'default' => 'data',
                    ],
                ],
            ],
            [
                'type' => 'utility',
                'node_type' => 'spreadsheet_file',
                'name' => 'Spreadsheet File',
                'description' => 'Read from or write to spreadsheet files (CSV, Excel)',
                'icon' => 'table',
                'color' => '#22c55e',
                'category' => 'utility',
                'inputs' => ['main'],
                'outputs' => ['main'],
                'properties' => [
                    [
                        'name' => 'operation',
                        'displayName' => 'Operation',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'Read from File', 'value' => 'read'],
                            ['label' => 'Write to File', 'value' => 'write'],
                        ],
                        'default' => 'read',
                    ],
                    [
                        'name' => 'file_format',
                        'displayName' => 'File Format',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'CSV', 'value' => 'csv'],
                            ['label' => 'Excel (xlsx)', 'value' => 'xlsx'],
                            ['label' => 'ODS', 'value' => 'ods'],
                        ],
                        'default' => 'csv',
                    ],
                    [
                        'name' => 'header_row',
                        'displayName' => 'Header Row',
                        'type' => 'boolean',
                        'default' => true,
                    ],
                ],
            ],

            // ================================================================================
            // RESPONSE / OUTPUT
            // ================================================================================
            [
                'type' => 'output',
                'node_type' => 'respond_to_webhook',
                'name' => 'Respond to Webhook',
                'description' => 'Send a response back to a webhook trigger',
                'icon' => 'send',
                'color' => '#10b981',
                'category' => 'output',
                'inputs' => ['main'],
                'outputs' => [],
                'properties' => [
                    [
                        'name' => 'respond_with',
                        'displayName' => 'Respond With',
                        'type' => 'select',
                        'options' => [
                            ['label' => 'First Incoming Item', 'value' => 'firstIncomingItem'],
                            ['label' => 'All Incoming Items', 'value' => 'allIncomingItems'],
                            ['label' => 'Text', 'value' => 'text'],
                            ['label' => 'JSON', 'value' => 'json'],
                            ['label' => 'No Data', 'value' => 'noData'],
                        ],
                        'default' => 'firstIncomingItem',
                    ],
                    [
                        'name' => 'response_body',
                        'displayName' => 'Response Body',
                        'type' => 'text',
                        'displayOptions' => ['show' => ['respond_with' => ['text']]],
                    ],
                    [
                        'name' => 'response_json',
                        'displayName' => 'Response JSON',
                        'type' => 'json',
                        'displayOptions' => ['show' => ['respond_with' => ['json']]],
                    ],
                    [
                        'name' => 'response_code',
                        'displayName' => 'Response Code',
                        'type' => 'number',
                        'default' => 200,
                    ],
                    [
                        'name' => 'response_headers',
                        'displayName' => 'Response Headers',
                        'type' => 'keyvalue',
                    ],
                ],
            ],

            // ================================================================================
            // INTERNAL (Start Node)
            // ================================================================================
            [
                'type' => 'internal',
                'node_type' => 'start',
                'name' => 'Start',
                'description' => 'Workflow start point (internal use)',
                'icon' => 'play-circle',
                'color' => '#22c55e',
                'category' => 'internal',
                'inputs' => [],
                'outputs' => ['main'],
                'properties' => [],
            ],
        ];

        foreach ($nodeTypes as $nodeType) {
            NodeType::updateOrCreate(
                ['node_type' => $nodeType['node_type']],
                $nodeType
            );
        }

        $this->command->info(' Seeded ' . count($nodeTypes) . ' node types for n8n clone.');
    }
}
